(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-e02a"],{"+D3Q":function(e,t,n){},"6bP5":function(e,t,n){"use strict";var r=n("+D3Q");n.n(r).a},"7sLR":function(e,t,n){"use strict";var r=n("Kh1d");n.n(r).a},Kh1d:function(e,t,n){},Pok7:function(e,t,n){"use strict";n.r(t);var r=n("bS4n"),i=n.n(r),o=n("Icpd"),s=n.n(o),a=n("Mpsw");function l(e,t){var n=[];return e.forEach(function(r){void 0===r._expanded&&a.default.set(r,"_expanded",t);var i=r.parentIds.split(",").filter(function(e){return e}),o=i.length>2?i.length-1:1;a.default.set(r,"_level",o);var s=null,l=[];e.forEach(function(e){1!==parseInt(r.parentId)&&e.id===r.parentId&&(s=e),e.parentId===r.id&&l.push(e)}),s&&a.default.set(r,"parent",s),l.length>0&&a.default.set(r,"children",l),n.push(r)}),n}var c={name:"TreeTable",props:{data:{type:[Array,Object],required:!0},columns:{type:Array,default:function(){return[]}},evalFunc:Function,evalArgs:Array,expandAll:{type:Boolean,default:!1},set:{type:Object,default:function(){return{edit:!1,delete:!1}}},listLoading:{type:Boolean,default:!0}},computed:{formatData:function(){var e=void 0;e=Array.isArray(this.data)?this.data:[this.data];var t=this.evalFunc||l,n=this.evalArgs?s()([e,this.expandAll],this.evalArgs):[e,this.expandAll];return t.apply(null,n)}},methods:{switchShow:function(e){return 1===parseInt(e)},switchInput:function(e,t){e.isShow=t?1:0},showRow:function(e){var t=1===parseInt(e.row.parentId)||e.row.parent._expanded&&e.row.parent._show;return e.row._show=t,t?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},toggleExpanded:function(e){var t=this.formatData[e];t._expanded=!t._expanded},iconShow:function(e,t){return 0===e&&t.children&&t.children.length>0},confirmEdit:function(e){this.$emit("edit",e)},confirmDelete:function(e,t){var n=this;if(this.formatData.some(function(e){return e.parentMenu===t.title}))return this.$message({type:"info",message:"该记录下有子记录,禁止删除"});this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.formatData.splice(e,1),n.$message({type:"success",message:"删除成功!"})}).catch(function(){n.$message({type:"info",message:"已取消删除"})})}}},u=(n("6bP5"),n("pKEv"),n("ZrdR")),p=Object(u.a)(c,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"permission"},[n("el-table",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.formatData,"row-style":e.showRow}},"el-table",e.$attrs,!1),[0===e.columns.length?n("el-table-column",{attrs:{width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row._level,function(e){return n("span",{key:e,staticClass:"ms-tree-space"})}),e._v(" "),e.iconShow(0,t.row)?n("span",{staticClass:"tree-ctrl",on:{click:function(n){e.toggleExpanded(t.$index)}}},[t.row._expanded?n("i",{staticClass:"el-icon-minus"}):n("i",{staticClass:"el-icon-plus"})]):e._e(),e._v("\n        "+e._s(t.$index)+"\n      ")]}}])}):[e._l(e.columns,function(t,r){return n("el-table-column",{key:t.value,attrs:{label:t.text,width:t.width},scopedSlots:e._u([{key:"default",fn:function(i){return[e._l(i.row._level,function(t){return 0===r?n("span",{key:t,staticClass:"ms-tree-space"}):e._e()}),e._v(" "),e.iconShow(r,i.row)?n("span",{staticClass:"tree-ctrl",on:{click:function(t){e.toggleExpanded(i.$index)}}},[i.row._expanded?n("i",{staticClass:"el-icon-minus"}):n("i",{staticClass:"el-icon-plus"})]):e._e(),e._v(" "),"icon"===t.value?[n("svg-icon",{attrs:{"icon-class":i.row[t.value]}})]:t.switch?[n("el-switch",{attrs:{value:e.switchShow(i.row[t.value])},on:{input:function(t){e.switchInput(i.row,t)}}})]:[e._v("\n            "+e._s(i.row[t.value])+"\n          ")]]}}])})}),e._v(" "),e.set.edit||e.set.delete?n("el-table-column",{attrs:{label:"操作",width:"192px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.edit?n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(n){e.confirmEdit(t.row)}}},[e._v("修改")]):e._e(),e._v(" "),t.row.delete?n("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(n){e.confirmDelete(t.$index,t.row)}}},[e._v("删除")]):e._e()]}}])}):e._e()],e._v(" "),e._t("default")],2)],1)},[],!1,null,"f7336cfc",null);p.options.__file="index.vue";var m=p.exports,d=n("ya69"),f=n("A2NP"),h=n.n(f),v=n("8t5x"),b={name:"Permission",components:{treeTable:m},data:function(){return{iconsMap:d.a,iconDialog:!1,parentDialog:!1,defaultProps:{children:"children",label:"name"},parentTempData:{},filterText:"",listLoading:!0,isEdit:!1,formShow:!1,columns:[{text:"名称",value:"name"},{text:"路径",value:"href"},{width:50,text:"图标",value:"icon"},{text:"可见",switch:!0,width:60,value:"isShow"},{text:"类型",width:55,value:"type"}],optionList:[{text:"排序",value:"sort",width:75},{text:"备注",value:"remarks"},{text:"权限标识",value:"permission"}],optionSelect:[],set:{edit:!0,delete:!0},ruleForm:{type:"1",parentId:"",name:"",href:"",icon:"",sort:null,isShow:1,permission:"",controller:"",remarks:""},rules:{name:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}],sort:[{required:!1,type:"number",message:"请输入数字值",trigger:"blur"}]}}},computed:i()({},Object(v.b)(["permissionList"]),{cloumnsList:function(){return this.columns.concat(this.optionSelect)},switchShow:function(){return!!parseInt(this.ruleForm.isShow)},formTitle:function(){return(this.isEdit?"修改":"新增")+"菜单"},generationTree:function(){var e=h()(this.permissionList,"parentId");for(var t in this.permissionIdKey){var n=this.permissionIdKey[t];e[t]&&(n.children=e[t])}return e[1]},permissionIdKey:function(){var e={};return this.permissionList.map(function(t){var n=t.id;e[n]=t}),e},permissionIdToName:function(){return this.permissionIdKey[this.ruleForm.parentId]?this.permissionIdKey[this.ruleForm.parentId].name:""}}),mounted:function(){this.getPermission()},methods:{switchInput:function(e){this.ruleForm.isShow=e?1:0},getPermission:function(){var e=this;this.listLoading=!0,this.$store.dispatch("GetPermission").then(function(){e.listLoading=!1})},addForm:function(){var e=this;this.isEdit=!1,this.formShow=!0,this.$nextTick(function(){e.resetForm("ruleForm")})},editForm:function(e){this.ruleForm=e,this.isEdit=!0,this.formShow=!0},submitForm:function(e){this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;alert("submit!")})},resetForm:function(e){this.$refs[e].resetFields()},handleClipboard:function(e){this.iconDialog=!1,this.ruleForm.icon=e},parentMenuClick:function(e){this.parentTempData=e},parentMenuConfirm:function(){this.parentDialog=!1,this.ruleForm.parentId=this.parentTempData.id},parentMenuClear:function(){this.ruleForm.parentId=null,this.parentTempData={}}}},w=(n("7sLR"),Object(u.a)(b,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container permission-container"},[n("div",{staticClass:"plan"},[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.addForm}},[e._v("新增规则")]),e._v(" "),n("div",{staticClass:"table-cloumns"},[n("el-checkbox-group",{model:{value:e.optionSelect,callback:function(t){e.optionSelect=t},expression:"optionSelect"}},e._l(e.optionList,function(t){return n("el-checkbox-button",{key:t.value,attrs:{label:t}},[e._v(e._s(t.text))])}))],1)],1),e._v(" "),n("tree-table",{staticClass:"permission-tree",attrs:{data:e.permissionList,"list-loading":e.listLoading,set:e.set,columns:e.cloumnsList,border:""},on:{edit:e.editForm}}),e._v(" "),n("el-dialog",{attrs:{visible:e.formShow,title:e.formTitle},on:{"update:visible":function(t){e.formShow=t}}},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"类型",prop:"type"}},[n("el-radio",{attrs:{label:"1"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},[e._v("菜单")]),e._v(" "),n("el-radio",{attrs:{label:"2"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},[e._v("按钮")])],1),e._v(" "),n("el-form-item",{attrs:{label:"上级菜单",prop:"parentId"}},[n("el-input",{attrs:{clearable:"",readonly:"",placeholder:"空为一级菜单"},model:{value:e.permissionIdToName,callback:function(t){e.permissionIdToName=t},expression:"permissionIdToName"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){e.parentDialog=!0}},slot:"append"})],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"名称",prop:"name"}},[n("el-input",{attrs:{placeholder:"菜单名"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),n("el-collapse-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:"1"===e.ruleForm.type,expression:"ruleForm.type==='1'"}]},[n("el-form-item",{attrs:{label:"路径",prop:"href"}},[n("el-input",{attrs:{placeholder:"页面路径"},model:{value:e.ruleForm.href,callback:function(t){e.$set(e.ruleForm,"href",t)},expression:"ruleForm.href"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"图标",prop:"icon"}},[n("el-input",{attrs:{clearable:"",readonly:""},model:{value:e.ruleForm.icon,callback:function(t){e.$set(e.ruleForm,"icon",t)},expression:"ruleForm.icon"}},[n("svg-icon",{attrs:{slot:"prepend","icon-class":e.ruleForm.icon},slot:"prepend"}),e._v(" "),n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){e.iconDialog=!0}},slot:"append"})],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"排序",prop:"sort"}},[n("el-input",{attrs:{placeholder:"排序由小到大"},model:{value:e.ruleForm.sort,callback:function(t){e.$set(e.ruleForm,"sort",e._n(t))},expression:"ruleForm.sort"}})],1)],1)]),e._v(" "),n("el-form-item",{attrs:{label:"可见",prop:"isShow"}},[n("el-switch",{attrs:{value:e.switchShow},on:{input:function(t){e.switchInput(t)}}})],1),e._v(" "),n("el-form-item",{attrs:{label:"权限标识",prop:"permission"}},[n("el-input",{attrs:{placeholder:"请输入权限标识"},model:{value:e.ruleForm.permission,callback:function(t){e.$set(e.ruleForm,"permission",t)},expression:"ruleForm.permission"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[n("el-input",{attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:e.ruleForm.remarks,callback:function(t){e.$set(e.ruleForm,"remarks",t)},expression:"ruleForm.remarks"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("立即创建")]),e._v(" "),n("el-button",{on:{click:function(t){e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),n("el-dialog",{attrs:{visible:e.iconDialog,title:"请选择图标"},on:{"update:visible":function(t){e.iconDialog=t}}},[n("div",{staticClass:"icons-wrapper"},e._l(e.iconsMap,function(t){return n("div",{key:t,staticClass:"icon-item",on:{click:function(n){e.handleClipboard(t)}}},[n("svg-icon",{attrs:{"icon-class":t,"class-name":"disabled"}}),e._v(" "),n("span",[e._v(e._s(t))])],1)}))]),e._v(" "),n("el-dialog",{attrs:{visible:e.parentDialog,title:"请选中上级菜单"},on:{"update:visible":function(t){e.parentDialog=t}}},[n("el-tree",{ref:"tree2",staticClass:"filter-tree",attrs:{data:e.generationTree,props:e.defaultProps},on:{"node-click":e.parentMenuClick}}),e._v(" "),n("div",{staticClass:"button-group"},[n("el-button",{attrs:{type:"primary"},on:{click:e.parentMenuConfirm}},[e._v("确定")]),e._v(" "),n("el-button",{on:{click:e.parentMenuClear}},[e._v("设置为一级菜单")])],1)],1)],1)},[],!1,null,"eeae3252",null));w.options.__file="index.vue";t.default=w.exports},Zhzm:function(e,t,n){},pKEv:function(e,t,n){"use strict";var r=n("Zhzm");n.n(r).a},ya69:function(e,t,n){"use strict";var r=/\.\/(.*)\.svg/,i=function(e){return e.keys()}(n("Uf/o")).map(function(e){return e.match(r)[1]});t.a=i}}]);